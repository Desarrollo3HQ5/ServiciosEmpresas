/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { CAMERA_BEEP } from "./ngx-scanner-qrcode.default";
/**
 * OVERRIDES
 * \@param variableKey
 * \@param config
 * \@param defaultConfig
 * \@return
 * @type {?}
 */
export const OVERRIDES = (/**
 * @param {?} variableKey
 * @param {?} config
 * @param {?} defaultConfig
 * @return {?}
 */
(variableKey, config, defaultConfig) => {
    if (config && Object.keys(config[variableKey]).length) {
        for (const key in defaultConfig) {
            /** @type {?} */
            const cloneDeep = JSON.parse(JSON.stringify(Object.assign({}, config[variableKey], { [key]: ((/** @type {?} */ (defaultConfig)))[key] })));
            config[variableKey] = config[variableKey].hasOwnProperty(key) ? config[variableKey] : cloneDeep;
        }
        return config[variableKey];
    }
    else {
        return defaultConfig;
    }
});
/**
 * Rxjs complete
 * \@param as
 * \@param data
 * \@param error
 * @type {?}
 */
export const AS_COMPLETE = (/**
 * @param {?} as
 * @param {?} data
 * @param {?=} error
 * @return {?}
 */
(as, data, error = null) => {
    error ? as.error(error) : as.next(data);
    as.complete();
});
/**
 * CAMERA_BEEP
 * \@param isPlay
 * \@return
 * @type {?}
 */
export const PLAY_AUDIO = (/**
 * @param {?=} isPlay
 * @return {?}
 */
(isPlay = false) => {
    if (isPlay === false)
        return;
    /** @type {?} */
    const audio = new Audio(CAMERA_BEEP);
    // when the sound has been loaded, execute your code
    audio.oncanplaythrough = (/**
     * @return {?}
     */
    () => {
        /** @type {?} */
        const promise = audio.play();
        if (promise) {
            promise.catch((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                if (e.name === "NotAllowedError" || e.name === "NotSupportedError") {
                    // console.log(e.name);
                }
            }));
        }
    });
});
/**
 * HAS_OWN_PROPERTY
 * Fix issue vs ng v 6-7-8
 * Optional chaining (?.) just have on ng v 9++
 * eg: HAS_OWN_PROPERTY(config, 'frameOptions.style') // output: boolean
 * \@param obj
 * \@param propertyPath
 * \@return
 * @type {?}
 */
export const HAS_OWN_PROPERTY = (/**
 * @param {?} obj
 * @param {?} propertyPath
 * @return {?}
 */
(obj, propertyPath) => {
    /** @type {?} */
    const properties = propertyPath.split(".");
    for (let i = 0; i < properties.length; i++) {
        /** @type {?} */
        let prop = properties[i];
        if (!obj.hasOwnProperty(prop)) {
            return false;
        }
        else {
            obj = obj[prop];
        }
    }
    return true;
});
/**
 * DRAW_RESULT
 * \@param code
 * \@param oriCanvas
 * \@param elTarget
 * \@return
 * @type {?}
 */
export const DRAW_RESULT = (/**
 * @param {?} code
 * @param {?} oriCanvas
 * @param {?} elTarget
 * @return {?}
 */
(code, oriCanvas, elTarget) => {
    /** @type {?} */
    let widthZoom;
    /** @type {?} */
    let heightZoom;
    /** @type {?} */
    let oriWidth = oriCanvas.width;
    /** @type {?} */
    let oriHeight = oriCanvas.height;
    /** @type {?} */
    let oriWHRatio = oriWidth / oriHeight;
    /** @type {?} */
    let imgWidth = parseInt(getComputedStyle(oriCanvas).width);
    /** @type {?} */
    let imgHeight = parseInt(getComputedStyle(oriCanvas).height);
    /** @type {?} */
    let imgWHRatio = imgWidth / imgHeight;
    /** @type {?} */
    let cvs = document.createElement("canvas");
    /** @type {?} */
    let ctx = (/** @type {?} */ (cvs.getContext('2d', { willReadFrequently: true })));
    ctx.globalCompositeOperation = "destination-over";
    /** @type {?} */
    let loc = {};
    loc.x1 = code.location.topLeftCorner.x;
    loc.y1 = code.location.topLeftCorner.y;
    loc.x2 = code.location.topRightCorner.x;
    loc.y2 = code.location.topRightCorner.y;
    loc.x3 = code.location.bottomLeftCorner.x;
    loc.y3 = code.location.bottomLeftCorner.y;
    loc.x4 = code.location.bottomRightCorner.x;
    loc.y4 = code.location.bottomRightCorner.y;
    /** @type {?} */
    let locXArr = [loc.x1, loc.x2, loc.x3, loc.x4];
    /** @type {?} */
    let locYArr = [loc.y1, loc.y2, loc.y3, loc.y4];
    /** @type {?} */
    let maxX = Math.max(loc.x1, loc.x2, loc.x3, loc.x4);
    /** @type {?} */
    let minX = Math.min(loc.x1, loc.x2, loc.x3, loc.x4);
    /** @type {?} */
    let maxY = Math.max(loc.y1, loc.y2, loc.y3, loc.y4);
    /** @type {?} */
    let minY = Math.min(loc.y1, loc.y2, loc.y3, loc.y4);
    /** @type {?} */
    let minXToY = locYArr[locXArr.indexOf(minX)];
    /** @type {?} */
    let minYToX = locXArr[locYArr.indexOf(minY)];
    /** @type {?} */
    let maxXToY = locYArr[locXArr.indexOf(maxX)];
    /** @type {?} */
    let maxYToX = locXArr[locYArr.indexOf(maxY)];
    if (oriWHRatio > imgWHRatio) {
        widthZoom = imgWidth / oriWidth;
        heightZoom = imgWidth / oriWHRatio / oriHeight;
        cvs.style.top = minY * heightZoom + (imgHeight - imgWidth / oriWHRatio) * 0.5 + "px";
        cvs.style.left = minX * widthZoom + "px";
        cvs.width = (maxX - minX) * widthZoom;
        cvs.height = (maxY - minY) * widthZoom;
        cvs.style.width = (maxX - minX) * widthZoom + "px";
        cvs.style.height = (maxY - minY) * widthZoom + "px";
    }
    else {
        heightZoom = imgHeight / oriHeight;
        widthZoom = (imgHeight * oriWHRatio) / oriWidth;
        cvs.style.top = minY * heightZoom + "px";
        cvs.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + "px";
        cvs.width = (maxX - minX) * heightZoom;
        cvs.height = (maxY - minY) * heightZoom;
        cvs.style.width = (maxX - minX) * heightZoom + "px";
        cvs.style.height = (maxY - minY) * heightZoom + "px";
    }
    cvs.style.zIndex = '1';
    cvs.style.position = "absolute";
    ctx.fillStyle = "#55f02880";
    /** @type {?} */
    const isSquare = (/**
     * @return {?}
     */
    () => {
        /** @type {?} */
        const left = Math.floor(loc.x1) - Math.floor(loc.x3);
        /** @type {?} */
        const right = Math.floor(loc.x2) - Math.floor(loc.x4);
        return ~~left <= 1 && ~~right <= 1 && code.location.topLeftFinderPattern.y == code.location.topRightFinderPattern.y;
    });
    if (!isSquare()) {
        /** @type {?} */
        const h1 = minXToY * heightZoom - minY * heightZoom;
        /** @type {?} */
        const w1 = minYToX * widthZoom - minX * widthZoom;
        /** @type {?} */
        const h2 = maxXToY * heightZoom - minY * heightZoom;
        /** @type {?} */
        const w2 = maxYToX * widthZoom - minX * widthZoom;
        ctx.beginPath();
        ctx.moveTo(0, h1);
        ctx.lineTo(w1, 0);
        ctx.lineTo(cvs.width, h2);
        ctx.lineTo(w2, cvs.height);
        ctx.fill();
    }
    else {
        ctx.fillRect(0, 0, cvs.width, cvs.height);
    }
    // Tooltip result
    /** @type {?} */
    const qrcodeTooltipTemp = document.createElement('div');
    qrcodeTooltipTemp.setAttribute('class', 'qrcode-tooltip-temp');
    qrcodeTooltipTemp.innerHTML = code.data;
    // Tooltip box
    /** @type {?} */
    const qrcodeTooltip = document.createElement('div');
    qrcodeTooltip.setAttribute('class', 'qrcode-tooltip');
    qrcodeTooltip.appendChild(qrcodeTooltipTemp);
    heightZoom = imgHeight / oriHeight;
    widthZoom = (imgHeight * oriWHRatio) / oriWidth;
    qrcodeTooltip.style.fontSize = widthZoom * 15 + 'px';
    qrcodeTooltip.style.top = minY * heightZoom + "px";
    qrcodeTooltip.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + "px";
    qrcodeTooltip.style.width = (maxX - minX) * heightZoom + "px";
    qrcodeTooltip.style.height = (maxY - minY) * heightZoom + "px";
    // Result text
    /** @type {?} */
    const resultText = document.createElement('input');
    resultText.value = code.data;
    resultText.style.zIndex = '3';
    resultText.style.fontSize = widthZoom * 15 + 'px';
    resultText.style.color = 'red';
    resultText.style.border = 'none';
    resultText.style.outline = 'none';
    resultText.style.position = 'absolute';
    resultText.style.background = '#ffffff00';
    resultText.style.width = '-webkit-fill-available';
    resultText.style.minWidth = qrcodeTooltip.style.width;
    resultText.setAttribute('class', 'qrcode-data');
    // Set position result text
    resultText.style.top = minY * heightZoom + (-20 * heightZoom) + "px";
    resultText.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + "px";
    if (elTarget) {
        elTarget.innerHTML = '';
        elTarget.appendChild(cvs);
        elTarget.appendChild(resultText);
        elTarget.appendChild(qrcodeTooltip);
    }
    return cvs;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNjYW5uZXItcXJjb2RlLmhlbHBlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1zY2FubmVyLXFyY29kZS8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtc2Nhbm5lci1xcmNvZGUuaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sOEJBQThCLENBQUM7Ozs7Ozs7OztBQVUzRCxNQUFNLE9BQU8sU0FBUzs7Ozs7O0FBQUcsQ0FBQyxXQUFtQixFQUFFLE1BQVcsRUFBRSxhQUFrQixFQUFFLEVBQUU7SUFDaEYsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUU7UUFDckQsS0FBSyxNQUFNLEdBQUcsSUFBSSxhQUFhLEVBQUU7O2tCQUN6QixTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxtQkFBTSxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUssRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsbUJBQUEsYUFBYSxFQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFHLENBQUM7WUFDbkgsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1NBQ2pHO1FBQ0QsT0FBTyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7S0FDNUI7U0FBTTtRQUNMLE9BQU8sYUFBYSxDQUFDO0tBQ3RCO0FBQ0gsQ0FBQyxDQUFBOzs7Ozs7OztBQVFELE1BQU0sT0FBTyxXQUFXOzs7Ozs7QUFBRyxDQUFDLEVBQXFCLEVBQUUsSUFBUyxFQUFFLEtBQUssR0FBRyxJQUFJLEVBQUUsRUFBRTtJQUM1RSxLQUFLLENB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LEdBQUcsQ0FBQztBQUNiLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jU3ViamVjdCB9IGZyb20gXCJyeGpzXCI7XHJcbmltcG9ydCB7IENBTUVSQV9CRUVQIH0gZnJvbSBcIi4vbmd4LXNjYW5uZXItcXJjb2RlLmRlZmF1bHRcIjtcclxuaW1wb3J0IHsgUVJDb2RlIH0gZnJvbSBcIi4vbmd4LXNjYW5uZXItcXJjb2RlLm9wdGlvbnNcIjtcclxuXHJcbi8qKlxyXG4gKiBPVkVSUklERVNcclxuICogQHBhcmFtIHZhcmlhYmxlS2V5IFxyXG4gKiBAcGFyYW0gY29uZmlnIFxyXG4gKiBAcGFyYW0gZGVmYXVsdENvbmZpZyBcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgT1ZFUlJJREVTID0gKHZhcmlhYmxlS2V5OiBzdHJpbmcsIGNvbmZpZzogYW55LCBkZWZhdWx0Q29uZmlnOiBhbnkpID0+IHtcclxuICBpZiAoY29uZmlnICYmIE9iamVjdC5rZXlzKGNvbmZpZ1t2YXJpYWJsZUtleV0pLmxlbmd0aCkge1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gZGVmYXVsdENvbmZpZykge1xyXG4gICAgICBjb25zdCBjbG9uZURlZXAgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHsgLi4uY29uZmlnW3ZhcmlhYmxlS2V5XSwgLi4ueyBba2V5XTogKGRlZmF1bHRDb25maWcgYXMgYW55KVtrZXldIH0gfSkpO1xyXG4gICAgICBjb25maWdbdmFyaWFibGVLZXldID0gY29uZmlnW3ZhcmlhYmxlS2V5XS5oYXNPd25Qcm9wZXJ0eShrZXkpID8gY29uZmlnW3ZhcmlhYmxlS2V5XSA6IGNsb25lRGVlcDtcclxuICAgIH1cclxuICAgIHJldHVybiBjb25maWdbdmFyaWFibGVLZXldO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gZGVmYXVsdENvbmZpZztcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogUnhqcyBjb21wbGV0ZVxyXG4gKiBAcGFyYW0gYXNcclxuICogQHBhcmFtIGRhdGFcclxuICogQHBhcmFtIGVycm9yXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgQVNfQ09NUExFVEUgPSAoYXM6IEFzeW5jU3ViamVjdDxhbnk+LCBkYXRhOiBhbnksIGVycm9yID0gbnVsbCkgPT4ge1xyXG4gIGVycm9yID8gYXMuZXJyb3IoZXJyb3IpIDogYXMubmV4dChkYXRhKTtcclxuICBhcy5jb21wbGV0ZSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENBTUVSQV9CRUVQXHJcbiAqIEBwYXJhbSBpc1BsYXkgXHJcbiAqIEByZXR1cm5zIFxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFBMQVlfQVVESU8gPSAoaXNQbGF5OiBib29sZWFuID0gZmFsc2UpID0+IHtcclxuICBpZiAoaXNQbGF5ID09PSBmYWxzZSkgcmV0dXJuO1xyXG4gIGNvbnN0IGF1ZGlvID0gbmV3IEF1ZGlvKENBTUVSQV9CRUVQKTtcclxuICAvLyB3aGVuIHRoZSBzb3VuZCBoYXMgYmVlbiBsb2FkZWQsIGV4ZWN1dGUgeW91ciBjb2RlXHJcbiAgYXVkaW8ub25jYW5wbGF5dGhyb3VnaCA9ICgpID0+IHtcclxuICAgIGNvbnN0IHByb21pc2UgPSBhdWRpby5wbGF5KCk7XHJcbiAgICBpZiAocHJvbWlzZSkge1xyXG4gICAgICBwcm9taXNlLmNhdGNoKChlKSA9PiB7XHJcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gXCJOb3RBbGxvd2VkRXJyb3JcIiB8fCBlLm5hbWUgPT09IFwiTm90U3VwcG9ydGVkRXJyb3JcIikge1xyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2coZS5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn07XHJcblxyXG4vKipcclxuICogSEFTX09XTl9QUk9QRVJUWVxyXG4gKiBGaXggaXNzdWUgdnMgbmcgdiA2LTctOFxyXG4gKiBPcHRpb25hbCBjaGFpbmluZyAoPy4pIGp1c3QgaGF2ZSBvbiBuZyB2IDkrK1xyXG4gKiBlZzogSEFTX09XTl9QUk9QRVJUWShjb25maWcsICdmcmFtZU9wdGlvbnMuc3R5bGUnKSAvLyBvdXRwdXQ6IGJvb2xlYW5cclxuICogQHBhcmFtIG9iaiBcclxuICogQHBhcmFtIHByb3BlcnR5UGF0aCBcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgSEFTX09XTl9QUk9QRVJUWSA9IChvYmo6IGFueSwgcHJvcGVydHlQYXRoOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCBwcm9wZXJ0aWVzID0gcHJvcGVydHlQYXRoLnNwbGl0KFwiLlwiKTtcclxuICBmb3IgKGxldCAgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGxldCBwcm9wID0gcHJvcGVydGllc1tpXTtcclxuICAgICAgaWYgKCFvYmouaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG9iaiA9IG9ialtwcm9wXTtcclxuICAgICAgfVxyXG4gIH1cclxuICByZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEUkFXX1JFU1VMVFxyXG4gKiBAcGFyYW0gY29kZSBcclxuICogQHBhcmFtIG9yaUNhbnZhcyBcclxuICogQHBhcmFtIGVsVGFyZ2V0IFxyXG4gKiBAcmV0dXJucyBcclxuICovXHJcbmV4cG9ydCBjb25zdCBEUkFXX1JFU1VMVCA9IChjb2RlOiBRUkNvZGUsIG9yaUNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGVsVGFyZ2V0OiBIVE1MQ2FudmFzRWxlbWVudCB8IEhUTUxEaXZFbGVtZW50KTogSFRNTENhbnZhc0VsZW1lbnQgPT4ge1xyXG4gIGxldCB3aWR0aFpvb207XHJcbiAgbGV0IGhlaWdodFpvb207XHJcbiAgbGV0IG9yaVdpZHRoID0gb3JpQ2FudmFzLndpZHRoO1xyXG4gIGxldCBvcmlIZWlnaHQgPSBvcmlDYW52YXMuaGVpZ2h0O1xyXG4gIGxldCBvcmlXSFJhdGlvID0gb3JpV2lkdGggLyBvcmlIZWlnaHQ7XHJcbiAgbGV0IGltZ1dpZHRoID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShvcmlDYW52YXMpLndpZHRoKTtcclxuICBsZXQgaW1nSGVpZ2h0ID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShvcmlDYW52YXMpLmhlaWdodCk7XHJcbiAgbGV0IGltZ1dIUmF0aW8gPSBpbWdXaWR0aCAvIGltZ0hlaWdodDtcclxuXHJcbiAgbGV0IGN2cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgbGV0IGN0eCA9IGN2cy5nZXRDb250ZXh0KCcyZCcsIHsgd2lsbFJlYWRGcmVxdWVudGx5OiB0cnVlIH0pIGFzIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcclxuICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gXCJkZXN0aW5hdGlvbi1vdmVyXCI7XHJcblxyXG4gIGxldCBsb2M6IGFueSA9IHt9O1xyXG4gIGxvYy54MSA9IGNvZGUubG9jYXRpb24udG9wTGVmdENvcm5lci54O1xyXG4gIGxvYy55MSA9IGNvZGUubG9jYXRpb24udG9wTGVmdENvcm5lci55O1xyXG4gIGxvYy54MiA9IGNvZGUubG9jYXRpb24udG9wUmlnaHRDb3JuZXIueDtcclxuICBsb2MueTIgPSBjb2RlLmxvY2F0aW9uLnRvcFJpZ2h0Q29ybmVyLnk7XHJcbiAgbG9jLngzID0gY29kZS5sb2NhdGlvbi5ib3R0b21MZWZ0Q29ybmVyLng7XHJcbiAgbG9jLnkzID0gY29kZS5sb2NhdGlvbi5ib3R0b21MZWZ0Q29ybmVyLnk7XHJcbiAgbG9jLng0ID0gY29kZS5sb2NhdGlvbi5ib3R0b21SaWdodENvcm5lci54O1xyXG4gIGxvYy55NCA9IGNvZGUubG9jYXRpb24uYm90dG9tUmlnaHRDb3JuZXIueTtcclxuICBcclxuICBsZXQgbG9jWEFyciA9IFtsb2MueDEsIGxvYy54MiwgbG9jLngzLCBsb2MueDRdO1xyXG4gIGxldCBsb2NZQXJyID0gW2xvYy55MSwgbG9jLnkyLCBsb2MueTMsIGxvYy55NF07XHJcbiAgXHJcbiAgbGV0IG1heFggPSBNYXRoLm1heChsb2MueDEsIGxvYy54MiwgbG9jLngzLCBsb2MueDQpO1xyXG4gIGxldCBtaW5YID0gTWF0aC5taW4obG9jLngxLCBsb2MueDIsIGxvYy54MywgbG9jLng0KTtcclxuICBsZXQgbWF4WSA9IE1hdGgubWF4KGxvYy55MSwgbG9jLnkyLCBsb2MueTMsIGxvYy55NCk7XHJcbiAgbGV0IG1pblkgPSBNYXRoLm1pbihsb2MueTEsIGxvYy55MiwgbG9jLnkzLCBsb2MueTQpO1xyXG4gIFxyXG4gIGxldCBtaW5YVG9ZID0gbG9jWUFycltsb2NYQXJyLmluZGV4T2YobWluWCldO1xyXG4gIGxldCBtaW5ZVG9YID0gbG9jWEFycltsb2NZQXJyLmluZGV4T2YobWluWSldO1xyXG4gIGxldCBtYXhYVG9ZID0gbG9jWUFycltsb2NYQXJyLmluZGV4T2YobWF4WCldO1xyXG4gIGxldCBtYXhZVG9YID0gbG9jWEFycltsb2NZQXJyLmluZGV4T2YobWF4WSldO1xyXG5cclxuICBpZiAob3JpV0hSYXRpbyA+IGltZ1dIUmF0aW8pIHtcclxuICAgIHdpZHRoWm9vbSA9IGltZ1dpZHRoIC8gb3JpV2lkdGg7XHJcbiAgICBoZWlnaHRab29tID0gaW1nV2lkdGggLyBvcmlXSFJhdGlvIC8gb3JpSGVpZ2h0O1xyXG4gICAgY3ZzLnN0eWxlLnRvcCA9IG1pblkgKiBoZWlnaHRab29tICsgKGltZ0hlaWdodCAtIGltZ1dpZHRoIC8gb3JpV0hSYXRpbykgKiAwLjUgKyBcInB4XCI7XHJcbiAgICBjdnMuc3R5bGUubGVmdCA9IG1pblggKiB3aWR0aFpvb20gKyBcInB4XCI7XHJcbiAgICBjdnMud2lkdGggPSAobWF4WCAtIG1pblgpICogd2lkdGhab29tO1xyXG4gICAgY3ZzLmhlaWdodCA9IChtYXhZIC0gbWluWSkgKiB3aWR0aFpvb207XHJcbiAgICBjdnMuc3R5bGUud2lkdGggPSAobWF4WCAtIG1pblgpICogd2lkdGhab29tICsgXCJweFwiO1xyXG4gICAgY3ZzLnN0eWxlLmhlaWdodCA9IChtYXhZIC0gbWluWSkgKiB3aWR0aFpvb20gKyBcInB4XCI7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhlaWdodFpvb20gPSBpbWdIZWlnaHQgLyBvcmlIZWlnaHQ7XHJcbiAgICB3aWR0aFpvb20gPSAoaW1nSGVpZ2h0ICogb3JpV0hSYXRpbykgLyBvcmlXaWR0aDtcclxuICAgIGN2cy5zdHlsZS50b3AgPSBtaW5ZICogaGVpZ2h0Wm9vbSArIFwicHhcIjtcclxuICAgIGN2cy5zdHlsZS5sZWZ0ID0gbWluWCAqIHdpZHRoWm9vbSArIChpbWdXaWR0aCAtIGltZ0hlaWdodCAqIG9yaVdIUmF0aW8pICogMC41ICsgXCJweFwiO1xyXG4gICAgY3ZzLndpZHRoID0gKG1heFggLSBtaW5YKSAqIGhlaWdodFpvb207XHJcbiAgICBjdnMuaGVpZ2h0ID0gKG1heFkgLSBtaW5ZKSAqIGhlaWdodFpvb207XHJcbiAgICBjdnMuc3R5bGUud2lkdGggPSAobWF4WCAtIG1pblgpICogaGVpZ2h0Wm9vbSArIFwicHhcIjtcclxuICAgIGN2cy5zdHlsZS5oZWlnaHQgPSAobWF4WSAtIG1pblkpICogaGVpZ2h0Wm9vbSArIFwicHhcIjtcclxuICB9XHJcblxyXG4gIGN2cy5zdHlsZS56SW5kZXggPSAnMSc7XHJcbiAgY3ZzLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4gIGN0eC5maWxsU3R5bGUgPSBcIiM1NWYwMjg4MFwiO1xyXG4gIFxyXG4gIGNvbnN0IGlzU3F1YXJlID0gKCkgPT4ge1xyXG4gICAgY29uc3QgbGVmdCA9IE1hdGguZmxvb3IobG9jLngxKSAtIE1hdGguZmxvb3IobG9jLngzKTtcclxuICAgIGNvbnN0IHJpZ2h0ID0gTWF0aC5mbG9vcihsb2MueDIpIC0gTWF0aC5mbG9vcihsb2MueDQpO1xyXG4gICAgcmV0dXJuIH5+bGVmdCA8PSAxICYmIH5+cmlnaHQgPD0gMSAmJiBjb2RlLmxvY2F0aW9uLnRvcExlZnRGaW5kZXJQYXR0ZXJuLnkgPT0gY29kZS5sb2NhdGlvbi50b3BSaWdodEZpbmRlclBhdHRlcm4ueTtcclxuICB9IFxyXG4gIFxyXG4gIGlmICghaXNTcXVhcmUoKSkge1xyXG4gICAgY29uc3QgaDEgPSBtaW5YVG9ZICogaGVpZ2h0Wm9vbSAtIG1pblkgKiBoZWlnaHRab29tO1xyXG4gICAgY29uc3QgdzEgPSBtaW5ZVG9YICogd2lkdGhab29tIC0gbWluWCAqIHdpZHRoWm9vbTtcclxuICAgIGNvbnN0IGgyID0gbWF4WFRvWSAqIGhlaWdodFpvb20gLSBtaW5ZICogaGVpZ2h0Wm9vbTtcclxuICAgIGNvbnN0IHcyID0gbWF4WVRvWCAqIHdpZHRoWm9vbSAtIG1pblggKiB3aWR0aFpvb207XHJcbiAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICBjdHgubW92ZVRvKDAsIGgxKTtcclxuICAgIGN0eC5saW5lVG8odzEsIDApO1xyXG4gICAgY3R4LmxpbmVUbyhjdnMud2lkdGgsIGgyKTtcclxuICAgIGN0eC5saW5lVG8odzIsIGN2cy5oZWlnaHQpO1xyXG4gICAgY3R4LmZpbGwoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY3R4LmZpbGxSZWN0KDAsIDAsIGN2cy53aWR0aCwgY3ZzLmhlaWdodCk7XHJcbiAgfVxyXG5cclxuICAvLyBUb29sdGlwIHJlc3VsdFxyXG4gIGNvbnN0IHFyY29kZVRvb2x0aXBUZW1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgcXJjb2RlVG9vbHRpcFRlbXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdxcmNvZGUtdG9vbHRpcC10ZW1wJyk7XHJcbiAgcXJjb2RlVG9vbHRpcFRlbXAuaW5uZXJIVE1MID0gY29kZS5kYXRhO1xyXG4gIFxyXG4gIC8vIFRvb2x0aXAgYm94XHJcbiAgY29uc3QgcXJjb2RlVG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIHFyY29kZVRvb2x0aXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdxcmNvZGUtdG9vbHRpcCcpO1xyXG4gIHFyY29kZVRvb2x0aXAuYXBwZW5kQ2hpbGQocXJjb2RlVG9vbHRpcFRlbXApO1xyXG4gIGhlaWdodFpvb20gPSBpbWdIZWlnaHQgLyBvcmlIZWlnaHQ7XHJcbiAgd2lkdGhab29tID0gKGltZ0hlaWdodCAqIG9yaVdIUmF0aW8pIC8gb3JpV2lkdGg7XHJcbiAgcXJjb2RlVG9vbHRpcC5zdHlsZS5mb250U2l6ZSA9IHdpZHRoWm9vbSAqIDE1ICsncHgnOyBcclxuICBxcmNvZGVUb29sdGlwLnN0eWxlLnRvcCA9IG1pblkgKiBoZWlnaHRab29tICsgXCJweFwiO1xyXG4gIHFyY29kZVRvb2x0aXAuc3R5bGUubGVmdCA9IG1pblggKiB3aWR0aFpvb20gKyAoaW1nV2lkdGggLSBpbWdIZWlnaHQgKiBvcmlXSFJhdGlvKSAqIDAuNSArIFwicHhcIjtcclxuICBxcmNvZGVUb29sdGlwLnN0eWxlLndpZHRoID0gKG1heFggLSBtaW5YKSAqIGhlaWdodFpvb20gKyBcInB4XCI7XHJcbiAgcXJjb2RlVG9vbHRpcC5zdHlsZS5oZWlnaHQgPSAobWF4WSAtIG1pblkpICogaGVpZ2h0Wm9vbSArIFwicHhcIjtcclxuICAvLyBSZXN1bHQgdGV4dFxyXG4gIGNvbnN0IHJlc3VsdFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gIHJlc3VsdFRleHQudmFsdWUgPSBjb2RlLmRhdGE7XHJcbiAgcmVzdWx0VGV4dC5zdHlsZS56SW5kZXggPSAnMyc7IFxyXG4gIHJlc3VsdFRleHQuc3R5bGUuZm9udFNpemUgPSB3aWR0aFpvb20gKiAxNSArJ3B4JzsgXHJcbiAgcmVzdWx0VGV4dC5zdHlsZS5jb2xvciA9ICdyZWQnO1xyXG4gIHJlc3VsdFRleHQuc3R5bGUuYm9yZGVyID0gJ25vbmUnO1xyXG4gIHJlc3VsdFRleHQuc3R5bGUub3V0bGluZSA9ICdub25lJztcclxuICByZXN1bHRUZXh0LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICByZXN1bHRUZXh0LnN0eWxlLmJhY2tncm91bmQgPSAnI2ZmZmZmZjAwJztcclxuICByZXN1bHRUZXh0LnN0eWxlLndpZHRoID0gJy13ZWJraXQtZmlsbC1hdmFpbGFibGUnO1xyXG4gIHJlc3VsdFRleHQuc3R5bGUubWluV2lkdGggPSBxcmNvZGVUb29sdGlwLnN0eWxlLndpZHRoO1xyXG4gIHJlc3VsdFRleHQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdxcmNvZGUtZGF0YScpO1xyXG4gIC8vIFNldCBwb3NpdGlvbiByZXN1bHQgdGV4dFxyXG4gIHJlc3VsdFRleHQuc3R5bGUudG9wID0gbWluWSAqIGhlaWdodFpvb20gKyAoLTIwICogaGVpZ2h0Wm9vbSkgKyBcInB4XCI7XHJcbiAgcmVzdWx0VGV4dC5zdHlsZS5sZWZ0ID0gbWluWCAqIHdpZHRoWm9vbSArIChpbWdXaWR0aCAtIGltZ0hlaWdodCAqIG9yaVdIUmF0aW8pICogMC41ICsgXCJweFwiO1xyXG4gIFxyXG4gIGlmIChlbFRhcmdldCkge1xyXG4gICAgZWxUYXJnZXQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICBlbFRhcmdldC5hcHBlbmRDaGlsZChjdnMpO1xyXG4gICAgZWxUYXJnZXQuYXBwZW5kQ2hpbGQocmVzdWx0VGV4dCk7XHJcbiAgICBlbFRhcmdldC5hcHBlbmRDaGlsZChxcmNvZGVUb29sdGlwKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBjdnM7XHJcbn0iXX0=
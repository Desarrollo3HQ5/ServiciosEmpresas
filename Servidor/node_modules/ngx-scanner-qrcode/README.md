# ngx-scanner-qrcode

This library is built to provide a solution scanner QR code.\
This library takes in raw images and will locate, extract and parse any QR code found within.\
This demo [github](https://id1945.github.io/ngx-scanner-qrcode), [stackblitz](https://stackblitz.com/edit/angular-6-ngx-scanner-qrcode).

![Logo](https://raw.githubusercontent.com/id1945/ngx-scanner-qrcode/master/ngx-scanner-qrcode.png)

## Installation

Install `ngx-scanner-qrcode` from `npm`:

```bash
npm install ngx-scanner-qrcode --save
```

Add wanted package to NgModule imports:
```typescript
import { NgxScannerQrcodeModule } from 'ngx-scanner-qrcode';
@NgModule({
    imports: [
        NgxScannerQrcodeModule
    ]
})
```

In the Component:

```html
<!-- For camera -->
<ngx-scanner-qrcode #action="scanner"></ngx-scanner-qrcode>

<!-- data  -->
<span>{{ (action.data.value)['data'] }}</span><!-- value -->
<span>{{ (action.data | async)['data'] }}</span><!-- async -->

<!-- Loading -->
<p *ngIf="action.isLoading">âŒ› Loading...</p>

<!-- start -->
<button (click)="action.isStart ? action.stop() : action.start()">{{action.isStart ? 'Stop' : 'Start'}}</button>
```

<details><summary><b>For image src</b></summary>

```html
<!-- For image src -->
<ngx-scanner-qrcode #action="scanner" [src]="'https://domain.com/test.png'"></ngx-scanner-qrcode>

<span>{{ (action.data.value)['data'] }}</span><!-- value -->
<span>{{ (action.data | async)['data'] }}</span><!-- async -->
```

</details>

<details><summary><b>For select files</b></summary>

```html
<!-- For select files -->
<input #file type="file" (change)="onSelects(file.files)" [multiple]="'multiple'" [accept]="'.jpg, .png, .gif, .jpeg'"/>

<div *ngFor="let item of qrCodeResult">
  <ngx-scanner-qrcode #actionFile="scanner" [src]="item.url" [config]="config"></ngx-scanner-qrcode>
  <p>{{ (actionFile.data | async)['data'] }}</p>
</div>
```

```typescript
import { Component } from '@angular/core';
import { NgxScannerQrcodeService, ScannerQRCodeResult } from 'ngx-scanner-qrcode';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  public qrCodeResult: ScannerQRCodeResult[] = [];

  constructor(private qrcode: NgxScannerQrcodeService) { }

  public onSelects(files: any) {
    this.qrcode.loadFiles(files).subscribe((res: ScannerQRCodeResult[]) => {
      this.qrCodeResult = res;
    });
  }
}
```

</details>

### API Documentation

#### Input

|   Field       |   Description                 |     Type                  |     Default     |
|   ---         |       ---                     |     ---                   |       ---       |
| [src]         | image url                     | string                    | -               |
| [isAuto]      | auto camera                   | boolean                   | false           |
| [isBeep]      | beep                          | boolean                   | true            |
| [isAlwaysEmit]| always emit object            | boolean                   | false           |
| [medias]      | setting video                 | MediaStreamConstraints    | ``` {audio:false,video:true} ``` |
| [config]      | config                        | BaseConfig                | ``` {src:... ,isAuto:... ,isBeep:... ,isAlwaysEmit:... ,config:... ,medias:...} ``` |

#### Ouput

| Field     | Description   | Type    | Default |
| ---       | ---           | ---     | ---     |
| (event)   | data response | string  | -       |
| (error)   | error         | any     | -       |

#### Component export

| Field             | Description               | Type                    | Default   |
| ---               | ---                       | ---                     | ---       |
| isStart           | status                    | boolean                 | false     | 
| isLoading         | status                    | boolean                 | false     | 
| isPause           | status                    | boolean                 | -         | 
| data              | data response             | BehaviorSubject         | null      |
| ---               | ---                       | ---                     | ---       |
| (start)           | start camera              | AsyncSubject            | -         |
| (stop)            | stop camera               | AsyncSubject            | -         |
| (play)            | play video                | AsyncSubject            | -         |
| (pause)           | pause video               | AsyncSubject            | -         |
| (loadImage)       | load image from src       | AsyncSubject            | -         |

#### Service

| Field       | Description         | Type                                | Default |
| ---         | ---                 | ---                                 | ---     |
| (loadFiles) | Scanner from files  | AsyncSubject<ScannerQRCodeResult[]> | []      |

#### Models

<details><summary><b>BaseConfig</b></summary>

```typescript
interface BaseConfig {
  src?: string;
  isAuto?: boolean;
  isDraw?: boolean;
  isBeep?: boolean;
  isAlwaysEmit?: boolean;
  medias?: MediaStreamConstraints;
}
```
</details>


<details><summary><b>ScannerQRCodeResult</b></summary>

```typescript
interface ScannerQRCodeResult {
  canvas?: HTMLCanvasElement;
  file?: File;
  name?: string;
  url?: string;
  data?: string;
  binaryData?: number[];
  chunks?: Chunks;
  version?: number;
  location?: {
    topRightCorner?: Point;
    topLeftCorner?: Point;
    bottomRightCorner?: Point;
    bottomLeftCorner?: Point;
    topRightFinderPattern?: Point;
    topLeftFinderPattern?: Point;
    bottomLeftFinderPattern?: Point;
    bottomRightAlignmentPattern?: Point;
  };
}
```
</details>

<details><summary><b>Chunks</b></summary>

```typescript
export declare type Chunks = Array<Chunk | ByteChunk | ECIChunk>;

export interface Chunk {
    type: Mode;
    text: string;
}

export interface ByteChunk {
    type: Mode.Byte | Mode.Kanji;
    bytes: number[];
}

export interface ECIChunk {
    type: Mode.ECI;
    assignmentNumber: number;
}

export interface DecodedQR {
    text: string;
    bytes: number[];
    chunks: Chunks;
    version: number;
}

export declare enum Mode {
    Numeric = "numeric",
    Alphanumeric = "alphanumeric",
    Byte = "byte",
    Kanji = "kanji",
    ECI = "eci"
}
```
</details>

<details><summary><b>Point</b></summary>

```typescript
interface Point {
    x: number;
    y: number;
}
```
</details>

#### Support versions
  
<table>
  <tr>
    <th colspan="2">Support versions</th>
  </tr>
  <tr>
    <td>Angular 6</td>
    <td>1.1.5</td>
  </tr>
</table>

#### Author Information
  
<table>
  <tr>
    <th colspan="2">Author Information</th>
  </tr>
  <tr>
    <td>Author</td>
    <td>DaiDH</td>
  </tr>
  <tr>
    <td>Phone</td>
    <td>+84845882882</td>
  </tr>
</table>

![Vietnam](https://raw.githubusercontent.com/id1945/id1945/master/vietnam.gif)

[MIT License](https://github.com/id1945/ngx-scanner-qrcode/blob/master/LICENSE). Copyright (c) 2021 DaiDH
{"version":3,"file":"ngx-scanner-qrcode.js.map","sources":["ng://ngx-scanner-qrcode/lib/ngx-scanner-qrcode.default.ts","ng://ngx-scanner-qrcode/lib/ngx-scanner-qrcode.helper.ts","ng://ngx-scanner-qrcode/lib/ngx-scanner-qrcode.service.ts","ng://ngx-scanner-qrcode/lib/ngx-scanner-qrcode.component.ts","ng://ngx-scanner-qrcode/lib/ngx-scanner-qrcode.module.ts"],"sourcesContent":["import { BaseConfig } from \"./ngx-scanner-qrcode.options\";\r\n\r\n/**\r\n * MediaStream\r\n * Use facingMode: environment to attemt to get the front camera on phones\r\n */\r\nexport const MEDIA_STREAM_DEFAULT: MediaStreamConstraints = {\r\n  audio: false,\r\n  video: true\r\n};\r\n\r\nexport const CONFIG_DEFAULT: BaseConfig = {\r\n  src: '',\r\n  isAuto: false,\r\n  isBeep: true,\r\n  isAlwaysEmit: false,\r\n  medias: MEDIA_STREAM_DEFAULT,\r\n};\r\n\r\n/**\r\n * Audio\r\n * Camera beep\r\n */\r\nexport const CAMERA_BEEP = \"data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=\";\r\n","import { AsyncSubject } from \"rxjs\";\r\nimport { CAMERA_BEEP } from \"./ngx-scanner-qrcode.default\";\r\nimport { QRCode } from \"./ngx-scanner-qrcode.options\";\r\n\r\n/**\r\n * OVERRIDES\r\n * @param variableKey \r\n * @param config \r\n * @param defaultConfig \r\n * @returns \r\n */\r\nexport const OVERRIDES = (variableKey: string, config: any, defaultConfig: any) => {\r\n  if (config && Object.keys(config[variableKey]).length) {\r\n    for (const key in defaultConfig) {\r\n      const cloneDeep = JSON.parse(JSON.stringify({ ...config[variableKey], ...{ [key]: (defaultConfig as any)[key] } }));\r\n      config[variableKey] = config[variableKey].hasOwnProperty(key) ? config[variableKey] : cloneDeep;\r\n    }\r\n    return config[variableKey];\r\n  } else {\r\n    return defaultConfig;\r\n  }\r\n};\r\n\r\n/**\r\n * Rxjs complete\r\n * @param as\r\n * @param data\r\n * @param error\r\n */\r\nexport const AS_COMPLETE = (as: AsyncSubject<any>, data: any, error = null) => {\r\n  error ? as.error(error) : as.next(data);\r\n  as.complete();\r\n};\r\n\r\n/**\r\n * CAMERA_BEEP\r\n * @param isPlay \r\n * @returns \r\n */\r\nexport const PLAY_AUDIO = (isPlay: boolean = false) => {\r\n  if (isPlay === false) return;\r\n  const audio = new Audio(CAMERA_BEEP);\r\n  // when the sound has been loaded, execute your code\r\n  audio.oncanplaythrough = () => {\r\n    const promise = audio.play();\r\n    if (promise) {\r\n      promise.catch((e) => {\r\n        if (e.name === \"NotAllowedError\" || e.name === \"NotSupportedError\") {\r\n          // console.log(e.name);\r\n        }\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * HAS_OWN_PROPERTY\r\n * Fix issue vs ng v 6-7-8\r\n * Optional chaining (?.) just have on ng v 9++\r\n * eg: HAS_OWN_PROPERTY(config, 'frameOptions.style') // output: boolean\r\n * @param obj \r\n * @param propertyPath \r\n * @returns \r\n */\r\nexport const HAS_OWN_PROPERTY = (obj: any, propertyPath: string) => {\r\n  const properties = propertyPath.split(\".\");\r\n  for (let  i = 0; i < properties.length; i++) {\r\n      let prop = properties[i];\r\n      if (!obj.hasOwnProperty(prop)) {\r\n          return false;\r\n      } else {\r\n          obj = obj[prop];\r\n      }\r\n  }\r\n  return true;\r\n};\r\n\r\n/**\r\n * DRAW_RESULT\r\n * @param code \r\n * @param oriCanvas \r\n * @param elTarget \r\n * @returns \r\n */\r\nexport const DRAW_RESULT = (code: QRCode, oriCanvas: HTMLCanvasElement, elTarget: HTMLCanvasElement | HTMLDivElement): HTMLCanvasElement => {\r\n  let widthZoom;\r\n  let heightZoom;\r\n  let oriWidth = oriCanvas.width;\r\n  let oriHeight = oriCanvas.height;\r\n  let oriWHRatio = oriWidth / oriHeight;\r\n  let imgWidth = parseInt(getComputedStyle(oriCanvas).width);\r\n  let imgHeight = parseInt(getComputedStyle(oriCanvas).height);\r\n  let imgWHRatio = imgWidth / imgHeight;\r\n\r\n  let cvs = document.createElement(\"canvas\");\r\n  let ctx = cvs.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n  ctx.globalCompositeOperation = \"destination-over\";\r\n\r\n  let loc: any = {};\r\n  loc.x1 = code.location.topLeftCorner.x;\r\n  loc.y1 = code.location.topLeftCorner.y;\r\n  loc.x2 = code.location.topRightCorner.x;\r\n  loc.y2 = code.location.topRightCorner.y;\r\n  loc.x3 = code.location.bottomLeftCorner.x;\r\n  loc.y3 = code.location.bottomLeftCorner.y;\r\n  loc.x4 = code.location.bottomRightCorner.x;\r\n  loc.y4 = code.location.bottomRightCorner.y;\r\n  \r\n  let locXArr = [loc.x1, loc.x2, loc.x3, loc.x4];\r\n  let locYArr = [loc.y1, loc.y2, loc.y3, loc.y4];\r\n  \r\n  let maxX = Math.max(loc.x1, loc.x2, loc.x3, loc.x4);\r\n  let minX = Math.min(loc.x1, loc.x2, loc.x3, loc.x4);\r\n  let maxY = Math.max(loc.y1, loc.y2, loc.y3, loc.y4);\r\n  let minY = Math.min(loc.y1, loc.y2, loc.y3, loc.y4);\r\n  \r\n  let minXToY = locYArr[locXArr.indexOf(minX)];\r\n  let minYToX = locXArr[locYArr.indexOf(minY)];\r\n  let maxXToY = locYArr[locXArr.indexOf(maxX)];\r\n  let maxYToX = locXArr[locYArr.indexOf(maxY)];\r\n\r\n  if (oriWHRatio > imgWHRatio) {\r\n    widthZoom = imgWidth / oriWidth;\r\n    heightZoom = imgWidth / oriWHRatio / oriHeight;\r\n    cvs.style.top = minY * heightZoom + (imgHeight - imgWidth / oriWHRatio) * 0.5 + \"px\";\r\n    cvs.style.left = minX * widthZoom + \"px\";\r\n    cvs.width = (maxX - minX) * widthZoom;\r\n    cvs.height = (maxY - minY) * widthZoom;\r\n    cvs.style.width = (maxX - minX) * widthZoom + \"px\";\r\n    cvs.style.height = (maxY - minY) * widthZoom + \"px\";\r\n  } else {\r\n    heightZoom = imgHeight / oriHeight;\r\n    widthZoom = (imgHeight * oriWHRatio) / oriWidth;\r\n    cvs.style.top = minY * heightZoom + \"px\";\r\n    cvs.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n    cvs.width = (maxX - minX) * heightZoom;\r\n    cvs.height = (maxY - minY) * heightZoom;\r\n    cvs.style.width = (maxX - minX) * heightZoom + \"px\";\r\n    cvs.style.height = (maxY - minY) * heightZoom + \"px\";\r\n  }\r\n\r\n  cvs.style.zIndex = '1';\r\n  cvs.style.position = \"absolute\";\r\n  ctx.fillStyle = \"#55f02880\";\r\n  \r\n  const isSquare = () => {\r\n    const left = Math.floor(loc.x1) - Math.floor(loc.x3);\r\n    const right = Math.floor(loc.x2) - Math.floor(loc.x4);\r\n    return ~~left <= 1 && ~~right <= 1 && code.location.topLeftFinderPattern.y == code.location.topRightFinderPattern.y;\r\n  } \r\n  \r\n  if (!isSquare()) {\r\n    const h1 = minXToY * heightZoom - minY * heightZoom;\r\n    const w1 = minYToX * widthZoom - minX * widthZoom;\r\n    const h2 = maxXToY * heightZoom - minY * heightZoom;\r\n    const w2 = maxYToX * widthZoom - minX * widthZoom;\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, h1);\r\n    ctx.lineTo(w1, 0);\r\n    ctx.lineTo(cvs.width, h2);\r\n    ctx.lineTo(w2, cvs.height);\r\n    ctx.fill();\r\n  } else {\r\n    ctx.fillRect(0, 0, cvs.width, cvs.height);\r\n  }\r\n\r\n  // Tooltip result\r\n  const qrcodeTooltipTemp = document.createElement('div');\r\n  qrcodeTooltipTemp.setAttribute('class', 'qrcode-tooltip-temp');\r\n  qrcodeTooltipTemp.innerHTML = code.data;\r\n  \r\n  // Tooltip box\r\n  const qrcodeTooltip = document.createElement('div');\r\n  qrcodeTooltip.setAttribute('class', 'qrcode-tooltip');\r\n  qrcodeTooltip.appendChild(qrcodeTooltipTemp);\r\n  heightZoom = imgHeight / oriHeight;\r\n  widthZoom = (imgHeight * oriWHRatio) / oriWidth;\r\n  qrcodeTooltip.style.fontSize = widthZoom * 15 +'px'; \r\n  qrcodeTooltip.style.top = minY * heightZoom + \"px\";\r\n  qrcodeTooltip.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n  qrcodeTooltip.style.width = (maxX - minX) * heightZoom + \"px\";\r\n  qrcodeTooltip.style.height = (maxY - minY) * heightZoom + \"px\";\r\n  // Result text\r\n  const resultText = document.createElement('input');\r\n  resultText.value = code.data;\r\n  resultText.style.zIndex = '3'; \r\n  resultText.style.fontSize = widthZoom * 15 +'px'; \r\n  resultText.style.color = 'red';\r\n  resultText.style.border = 'none';\r\n  resultText.style.outline = 'none';\r\n  resultText.style.position = 'absolute';\r\n  resultText.style.background = '#ffffff00';\r\n  resultText.style.width = '-webkit-fill-available';\r\n  resultText.style.minWidth = qrcodeTooltip.style.width;\r\n  resultText.setAttribute('class', 'qrcode-data');\r\n  // Set position result text\r\n  resultText.style.top = minY * heightZoom + (-20 * heightZoom) + \"px\";\r\n  resultText.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n  \r\n  if (elTarget) {\r\n    elTarget.innerHTML = '';\r\n    elTarget.appendChild(cvs);\r\n    elTarget.appendChild(resultText);\r\n    elTarget.appendChild(qrcodeTooltip);\r\n  }\r\n\r\n  return cvs;\r\n}","import { Injectable } from '@angular/core';\r\nimport { AsyncSubject } from 'rxjs';\r\nimport { AS_COMPLETE } from './ngx-scanner-qrcode.helper';\r\nimport { ScannerQRCodeResult } from './ngx-scanner-qrcode.options';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgxScannerQrcodeService {\r\n\r\n  /**\r\n   * Load files\r\n   * @param files \r\n   * @return AsyncSubject\r\n   */\r\n  public loadFiles(files: File[] = []): AsyncSubject<ScannerQRCodeResult[]> {\r\n    const as = new AsyncSubject<ScannerQRCodeResult[]>();\r\n    Promise.all(Object.assign([], files).map(m => this.readAsDataURL(m))).then((img: ScannerQRCodeResult[]) => AS_COMPLETE(as, img)).catch((error: any) => AS_COMPLETE(as, null, error));\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * readAsDataURL\r\n   * @param file \r\n   * @return Promise\r\n   */\r\n  private readAsDataURL(file: File): Promise<ScannerQRCodeResult> {\r\n    /** drawImage **/\r\n    return new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.onload = () => {\r\n        const objectFile = {\r\n          name: file.name,\r\n          file: file,\r\n          base64: fileReader.result as string,\r\n          url: URL.createObjectURL(file)\r\n        };\r\n        resolve(objectFile);\r\n      }\r\n      fileReader.onerror = (error: any) => reject(error);\r\n      fileReader.readAsDataURL(file);\r\n    })\r\n  }\r\n}","import { Component, ElementRef, EventEmitter, OnDestroy, OnInit, ViewChild, ViewEncapsulation } from '@angular/core';\r\nimport { BehaviorSubject, AsyncSubject } from 'rxjs';\r\nimport jsQR from 'jsqr';\r\nimport { AS_COMPLETE, DRAW_RESULT, HAS_OWN_PROPERTY, OVERRIDES, PLAY_AUDIO } from './ngx-scanner-qrcode.helper';\r\nimport { BaseConfig, ScannerQRCodeResult } from './ngx-scanner-qrcode.options';\r\nimport { CONFIG_DEFAULT, MEDIA_STREAM_DEFAULT } from './ngx-scanner-qrcode.default';\r\n\r\n\r\n@Component({\r\n  selector: 'ngx-scanner-qrcode',\r\n  templateUrl: './ngx-scanner-qrcode.component.html',\r\n  styleUrls: ['./ngx-scanner-qrcode.component.scss'],\r\n  host: { 'class': 'ngx-scanner-qrcode' },\r\n  exportAs: 'scanner',\r\n  inputs: ['src', 'isAuto', 'isBeep', 'isAlwaysEmit', 'config', 'medias'],\r\n  outputs: ['event', 'error'],\r\n  queries: {\r\n    video: new ViewChild('video'),\r\n    canvas: new ViewChild('canvas'),\r\n    resultsPanel: new ViewChild('resultsPanel')\r\n  },\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class NgxScannerQrcodeComponent implements OnInit, OnDestroy {\r\n\r\n  /**\r\n   * Element\r\n   * playsinline required to tell iOS safari we don't want fullscreen\r\n   */\r\n  public video!: ElementRef<HTMLVideoElement>;\r\n  public canvas!: ElementRef<HTMLCanvasElement>;\r\n  public resultsPanel!: ElementRef<HTMLDivElement>;\r\n\r\n  /**\r\n   * EventEmitter\r\n   */\r\n  public error = new EventEmitter<any | null>();\r\n  public event = new EventEmitter<ScannerQRCodeResult>();\r\n\r\n  /**\r\n   * Input\r\n   */\r\n  public src: string | undefined = CONFIG_DEFAULT.src;\r\n  public isAuto: boolean | undefined = CONFIG_DEFAULT.isAuto;\r\n  public isBeep: boolean | undefined = CONFIG_DEFAULT.isBeep;\r\n  public isAlwaysEmit: boolean | undefined = CONFIG_DEFAULT.isAlwaysEmit;\r\n  public config: BaseConfig = CONFIG_DEFAULT;\r\n  public medias: MediaStreamConstraints | undefined = CONFIG_DEFAULT.medias;\r\n\r\n  /**\r\n   * Export\r\n   */\r\n  public isStart: boolean = false;\r\n  public isLoading: boolean = false;\r\n  public data = new BehaviorSubject<ScannerQRCodeResult>({});\r\n\r\n  /**\r\n   * Private\r\n   */\r\n  private rAF_ID: any;\r\n\r\n  ngOnInit(): void {\r\n    this.overrideConfig();\r\n    if (this.src) {\r\n      this.loadImage(this.src);\r\n    } else if (this.isAuto) {\r\n      this.start();\r\n    }\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n   * start\r\n   * @return AsyncSubject\r\n   */\r\n  public start(): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isStart) {\r\n      // Reject\r\n      AS_COMPLETE(as, false);\r\n    } else {\r\n      // Loading on\r\n      this.status(false, true);\r\n      /**\r\n       * MediaStream\r\n       * Use facingMode: environment to attemt to get the front camera on phones\r\n       */\r\n      navigator.mediaDevices.getUserMedia(this.medias).then((stream: MediaStream) => {\r\n        this.video.nativeElement.srcObject = stream;\r\n        this.video.nativeElement.onloadedmetadata = () => {\r\n          this.video.nativeElement.play();\r\n          this.requestAnimationFrame();\r\n          this.status(true, false);\r\n          AS_COMPLETE(as, true);\r\n        }\r\n      }).catch(error => {\r\n        this.status(false, false);\r\n        this.eventEmit(false, error);\r\n        AS_COMPLETE(as, false, error);\r\n      });\r\n    }\r\n\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * stop\r\n   * @return AsyncSubject\r\n   */\r\n  public stop(): AsyncSubject<any> {\r\n    this.eventEmit(null);\r\n    this.status(false, false);\r\n    const as = new AsyncSubject<any>();\r\n    try {\r\n      this.removeCanvas();\r\n      clearInterval(this.rAF_ID);\r\n      (this.video.nativeElement.srcObject as MediaStream).getTracks().forEach((track: any) => {\r\n        track.stop();\r\n        AS_COMPLETE(as, true);\r\n      });\r\n    } catch (error) {\r\n      this.eventEmit(false, error);\r\n      AS_COMPLETE(as, false, error as any);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * play\r\n   * @return AsyncSubject\r\n   */\r\n  public play(): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isPause) {\r\n      this.video.nativeElement.play();\r\n      this.requestAnimationFrame();\r\n      AS_COMPLETE(as, true);\r\n    } else {\r\n      AS_COMPLETE(as, false);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * pause\r\n   * @return AsyncSubject \r\n   */\r\n  public pause(): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isStart) {\r\n      clearInterval(this.rAF_ID);\r\n      this.video.nativeElement.pause();\r\n      AS_COMPLETE(as, true);\r\n    } else {\r\n      AS_COMPLETE(as, false);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * loadImage\r\n   * @param src \r\n   */\r\n  public loadImage(src: string): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    // Loading on\r\n    this.status(false, true);\r\n    // Set the src of this Image object.\r\n    const image = new Image();\r\n    // Setting cross origin value to anonymous\r\n    image.setAttribute('crossOrigin', 'anonymous');\r\n    // When our image has loaded.\r\n    image.onload = () => {\r\n      this.drawImage(image, (flag: boolean) => { \r\n        this.status(false, false);\r\n        AS_COMPLETE(as, flag);\r\n      });\r\n    };\r\n    // Set src\r\n    image.src = src;\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * window: resize\r\n   * Draw again!\r\n   */\r\n  private resize(): void {\r\n    window.addEventListener(\"resize\", () => this.data.subscribe(res => {\r\n      if (HAS_OWN_PROPERTY(res, 'location')) {\r\n        DRAW_RESULT(res as any, this.canvas.nativeElement, this.resultsPanel.nativeElement);\r\n      } \r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Override config\r\n   * @return void\r\n   */\r\n  private overrideConfig(): void {\r\n    if (HAS_OWN_PROPERTY(this.config, 'src')) this.src = this.config.src;\r\n    if (HAS_OWN_PROPERTY(this.config, 'isAuto')) this.isAuto = this.config.isAuto;\r\n    if (HAS_OWN_PROPERTY(this.config, 'isBeep')) this.isBeep = this.config.isBeep;\r\n    if (HAS_OWN_PROPERTY(this.config, 'isAlwaysEmit')) this.isAlwaysEmit = this.config.isAlwaysEmit;\r\n    if (HAS_OWN_PROPERTY(this.config, 'medias')) this.medias = OVERRIDES('medias', this.config, MEDIA_STREAM_DEFAULT);\r\n  }\r\n\r\n  /**\r\n   * drawImage\r\n   * @param element \r\n   * @param callback \r\n   */\r\n  private drawImage(element: HTMLImageElement | HTMLVideoElement, callback: Function = () => {}): void {\r\n    // Get the canvas element by using the getElementById method.\r\n    const canvas = this.canvas.nativeElement;\r\n    // Get a 2D drawing context for the canvas.\r\n    const ctx = canvas.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n    // HTMLImageElement size\r\n    if (element instanceof HTMLImageElement) {\r\n      canvas.width = element.naturalWidth;\r\n      canvas.height = element.naturalHeight;\r\n      element.style.visibility = '';\r\n      this.video.nativeElement.style.visibility = 'hidden';\r\n    }\r\n    // HTMLVideoElement size\r\n    if (element instanceof HTMLVideoElement) {\r\n      canvas.width = element.videoWidth;\r\n      canvas.height = element.videoHeight;\r\n      element.style.visibility = '';\r\n      this.canvas.nativeElement.style.visibility = 'hidden';\r\n    }\r\n    // Draw image\r\n    ctx.drawImage(element, 0, 0, canvas.width, canvas.height);\r\n    // Data image\r\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    // Draw frame\r\n    const code = jsQR(imageData.data, imageData.width, imageData.height, { inversionAttempts: \"attemptBoth\" }); /* \"dontInvert\" | \"onlyInvert\" | \"attemptBoth\" | \"invertFirst\" */\r\n    if (code) {\r\n      DRAW_RESULT(code, Object.freeze(this.canvas.nativeElement), this.resultsPanel.nativeElement);\r\n\r\n      // toBlob and emit data\r\n      const EMIT_DATA = () => this.eventEmit({...code, canvas: canvas});\r\n     \r\n      // HTMLImageElement\r\n      if (element instanceof HTMLImageElement) {\r\n        callback(true);\r\n        EMIT_DATA();\r\n        PLAY_AUDIO(this.isBeep);\r\n      } \r\n      // HTMLVideoElement\r\n      if (element instanceof HTMLVideoElement) {\r\n        if (this.isAlwaysEmit) {\r\n          EMIT_DATA();\r\n          PLAY_AUDIO(this.isBeep);\r\n        } else if (code.data !== (this.data.value as any)['data']) {\r\n          EMIT_DATA();\r\n          PLAY_AUDIO(this.isBeep);\r\n        }\r\n      }\r\n    } else {\r\n      callback(false);\r\n      this.removeCanvas();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * removeCanvas\r\n   */\r\n  private removeCanvas(): void {\r\n    Object.assign([], this.resultsPanel.nativeElement.childNodes).forEach(el => this.resultsPanel.nativeElement.removeChild(el));\r\n  }\r\n\r\n  /**\r\n   * status\r\n   * @param isStart \r\n   * @param isLoading \r\n   */\r\n  private status(isStart: boolean, isLoading: boolean): void {\r\n    this.isStart = isStart;\r\n    this.isLoading = isLoading;\r\n  }\r\n\r\n  /**\r\n   * eventEmit\r\n   * @param response \r\n   * @param error \r\n   */\r\n  private eventEmit(response: any = false, error: any = false): void {\r\n    (response !== false) && this.data.next(response || { data: null });\r\n    (response !== false) && this.event.emit(response || { data: null });\r\n    (error !== false) && this.error.emit(error || null);\r\n  }\r\n\r\n  /**\r\n   * Single-thread\r\n   * Loop Recording on Camera\r\n   * Must be destroy request \r\n   * requestAnimationFrame\r\n   */\r\n  private requestAnimationFrame(): void {\r\n    this.rAF_ID = setInterval(() => {\r\n      if (this.video.nativeElement.readyState === this.video.nativeElement.HAVE_ENOUGH_DATA) {\r\n        this.drawImage(this.video.nativeElement);\r\n      }\r\n    }, 40);\r\n  }\r\n\r\n  /**\r\n   * Status of camera\r\n   * @return boolean\r\n   */\r\n  get isPause(): boolean {\r\n    return this.isStart && this.video.nativeElement.paused;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.pause();\r\n  }\r\n}","import { NgModule } from \"@angular/core\";\r\nimport { NgxScannerQrcodeService } from \"./ngx-scanner-qrcode.service\";\r\nimport { NgxScannerQrcodeComponent } from \"./ngx-scanner-qrcode.component\";\r\n\r\n\r\n@NgModule({\r\n  declarations: [NgxScannerQrcodeComponent],\r\n  exports: [NgxScannerQrcodeComponent],\r\n  providers: [NgxScannerQrcodeService],\r\n})\r\nexport class NgxScannerQrcodeModule {}\r\n"],"names":[],"mappings":"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"}
